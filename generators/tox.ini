[tox]
envlist = django{18,19,110}
skipsdist = True

[testenv]
recreate = True
deps =
    django18: Django>=1.8,<1.9
    django19: Django>=1.9,<1.10
    django110: Django>=1.10,<1.11
commands =
    python -c "import os; os.mkdir('{toxworkdir}/{envname}/_')"
    django-admin startproject application {toxworkdir}/{envname}/_
    sed -i \
        -e '/^Generated by .django-admin startproject. using Django/d' \
        -e '/^For more information on this file, see/d' \
        -e '/^For the full list of settings and their values, see/d' \
        -e '/^https:..docs.djangoproject.com.en..*.settings/d' \
        -e '/^# Quick-start development settings - unsuitable for production/d' \
        -e '/^# https:..docs.djangoproject.com.en./d' \
        -e '/^# See https:..docs.djangoproject.com.en./d' \
        -e '/^# Build paths inside the project like this:/d' \
        -e 's/^import os/from os.path import abspath, dirname, join/' \
        -e 's/os.path.dirname(os.path.dirname(os.path.abspath(__file__)))/dirname(dirname(abspath(__file__)))/' \
        -e 's/os.path.join(/join(/g' \
        -e '/^# SECURITY WARNING: /d' \
        {toxworkdir}/{envname}/_/application/settings.py
whitelist_externals =
    sed

[testenv:clean]
deps =
commands =
    python -c "import shutil; shutil.rmtree('{toxworkdir}',ignore_errors=True)"
